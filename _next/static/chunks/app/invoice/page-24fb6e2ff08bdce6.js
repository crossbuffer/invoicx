(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{82173:(e,t,a)=>{Promise.resolve().then(a.bind(a,94639))},94639:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_});var s=a(95155),l=a(12115),r=a(5468),n=a(42008),i=a(17281),o=a(77803),c=a(94936),d=a(62113),u=a(53998),m=a(66605),x=a(93800),h=a(20588),g=a(99253),v=a(30633),y=a(6984),p=a(16321),f=a(10142),j=a(94677),b=a(13528),C=a(38684),N=a(27317),S=a(95484),w=a(21387),D=a(75712),F=a(52997),z=a(5565);let E=[{label:"Helvetica",value:"helvetica"},{label:"Times",value:"times"},{label:"Courier",value:"courier"}],T=[{label:"Classic",value:"classic"},{label:"Modern",value:"modern"},{label:"Minimal",value:"minimal"}],I=[{label:"MM/DD/YYYY",value:"MM/DD/YYYY"},{label:"DD/MM/YYYY",value:"DD/MM/YYYY"},{label:"YYYY-MM-DD",value:"YYYY-MM-DD"}];function Y(e){let{isOpen:t,onClose:a,onSave:i,initialSettings:o}=e,[u,m]=(0,l.useState)("general"),[x,h]=(0,l.useState)(o||p.a),[g,v]=(0,l.useState)(!1),[f,Y]=(0,l.useState)(null),A=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(t){v(!1);let e=localStorage.getItem("quickinvoice_logo");e&&Y(e)}else m("general"),h(o||p.a),Y(null)},[t,o]);let P=(0,l.useCallback)(()=>{v(!0),setTimeout(()=>{m("general"),a(),v(!1)},0)},[a]),R=(0,l.useCallback)(()=>{try{var e;let t={...x,template:{...p.a.template,...x.template,fontSize:{...p.a.template.fontSize,...(null===(e=x.template)||void 0===e?void 0:e.fontSize)||{}}}};localStorage.setItem("quickinvoice_settings",JSON.stringify(t)),f?localStorage.setItem("quickinvoice_logo",f):localStorage.removeItem("quickinvoice_logo"),i(t),P()}catch(e){console.error("Error saving settings:",e)}},[x,i,P,f]),B=e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if(a.size>5e5){alert("Logo file size should be less than 500KB");return}let e=new FileReader;e.onloadend=()=>{Y(e.result),h(e=>({...e,logoEnabled:!0}))},e.readAsDataURL(a)}},k=()=>{Y(null),h(e=>({...e,logoEnabled:!1})),A.current&&(A.current.value="")};return t||g?(0,s.jsx)(j.Y,{size:"2xl",isOpen:t,onClose:P,scrollBehavior:"inside",isDismissable:!0,hideCloseButton:!1,classNames:{wrapper:"z-[1000]",base:"z-[1000]"},children:(0,s.jsx)(b.g,{children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.c,{children:"Settings"}),(0,s.jsx)(N.h,{children:(0,s.jsxs)(S.r,{selectedKey:u,onSelectionChange:e=>m(e.toString()),classNames:{tabList:"gap-4",cursor:"w-full",tab:"max-w-fit px-4 h-10"},children:[(0,s.jsx)(w.i,{title:"General",children:(0,s.jsxs)("div",{className:"space-y-6 py-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Company Logo"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[f?(0,s.jsx)("div",{className:"relative w-32 h-32 border rounded-lg overflow-hidden",children:(0,s.jsx)(z.default,{src:f,alt:"Company Logo",fill:!0,className:"object-contain"})}):(0,s.jsx)("div",{className:"w-32 h-32 border rounded-lg flex items-center justify-center bg-gray-50",children:(0,s.jsx)("p",{className:"text-gray-400 text-sm text-center px-2",children:"No logo uploaded"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:B,className:"hidden",ref:A}),(0,s.jsx)(c.T,{color:"primary",variant:"flat",onPress:()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.click()},children:"Upload Logo"}),f&&(0,s.jsx)(c.T,{color:"danger",variant:"light",onPress:k,children:"Remove Logo"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Max file size: 500KB",(0,s.jsx)("br",{}),"Recommended size: 300x300px"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Show Logo on Invoice"}),(0,s.jsx)(D.Z,{isSelected:x.logoEnabled,isDisabled:!f,onValueChange:e=>h({...x,logoEnabled:e})})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Business Details"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(d.r,{label:"Default Business Name",value:x.defaultBusinessName,onChange:e=>h({...x,defaultBusinessName:e.target.value})}),(0,s.jsx)(d.r,{label:"Default Business Email",value:x.defaultBusinessEmail,onChange:e=>h({...x,defaultBusinessEmail:e.target.value})}),(0,s.jsx)(d.r,{label:"Default Business Address",value:x.defaultBusinessAddress,onChange:e=>h({...x,defaultBusinessAddress:e.target.value})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Invoice Settings"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(d.r,{type:"number",label:"Default Tax Rate (%)",value:(100*x.defaultTaxRate).toString(),onChange:e=>h({...x,defaultTaxRate:Number(e.target.value)/100})}),(0,s.jsx)(d.r,{type:"number",label:"Default Due Days",value:x.defaultDueDays.toString(),onChange:e=>h({...x,defaultDueDays:Number(e.target.value)})}),(0,s.jsx)(y.P,{label:"Default Notes",value:x.defaultNotes,onChange:e=>h({...x,defaultNotes:e.target.value})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"PDF Settings"}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)(d.r,{label:"Default Currency",value:x.defaultCurrency,onChange:e=>h({...x,defaultCurrency:e.target.value})})})]})]})},"general"),(0,s.jsx)(w.i,{title:"Template",children:(0,s.jsxs)("div",{className:"space-y-6 py-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Colors"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{children:"Primary Color:"}),(0,s.jsx)(d.r,{type:"color",value:x.template.primaryColor,className:"w-24",onChange:e=>h({...x,template:{...x.template,primaryColor:e.target.value}})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{children:"Secondary Color:"}),(0,s.jsx)(d.r,{type:"color",value:x.template.secondaryColor,className:"w-24",onChange:e=>h({...x,template:{...x.template,secondaryColor:e.target.value}})})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Typography"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(r.d,{label:"Font Family",selectedKeys:[x.template.fontFamily],onChange:e=>h({...x,template:{...x.template,fontFamily:e.target.value}}),children:E.map(e=>(0,s.jsx)(n.y,{value:e.value,children:e.label},e.value))}),(0,s.jsx)(d.r,{type:"number",label:"Header Font Size",value:x.template.fontSize.header.toString(),onChange:e=>h({...x,template:{...x.template,fontSize:{...x.template.fontSize,header:Number(e.target.value)}}})}),(0,s.jsx)(d.r,{type:"number",label:"Subheader Font Size",value:x.template.fontSize.subheader.toString(),onChange:e=>h({...x,template:{...x.template,fontSize:{...x.template.fontSize,subheader:Number(e.target.value)}}})}),(0,s.jsx)(d.r,{type:"number",label:"Body Font Size",value:x.template.fontSize.body.toString(),onChange:e=>h({...x,template:{...x.template,fontSize:{...x.template.fontSize,body:Number(e.target.value)}}})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Layout"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(r.d,{label:"Layout Style",selectedKeys:[x.template.layout],onChange:e=>h({...x,template:{...x.template,layout:e.target.value}}),children:T.map(e=>(0,s.jsx)(n.y,{value:e.value,children:e.label},e.value))}),(0,s.jsx)(r.d,{label:"Date Format",selectedKeys:[x.template.dateFormat],onChange:e=>h({...x,template:{...x.template,dateFormat:e.target.value}}),children:I.map(e=>(0,s.jsx)(n.y,{value:e.value,children:e.label},e.value))}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Show Header"}),(0,s.jsx)(D.Z,{isSelected:x.template.showHeader,onValueChange:e=>h({...x,template:{...x.template,showHeader:e}})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Show Footer"}),(0,s.jsx)(D.Z,{isSelected:x.template.showFooter,onValueChange:e=>h({...x,template:{...x.template,showFooter:e}})})]})]})]})]})},"template")]})}),(0,s.jsxs)(F.q,{children:[(0,s.jsx)(c.T,{color:"danger",variant:"light",onPress:P,children:"Cancel"}),(0,s.jsx)(c.T,{color:"primary",onPress:R,children:"Save Settings"})]})]})})}):null}let A={items:[],categories:["Products","Services","Other"]};function P(e){let{isOpen:t,onClose:a,onSave:i,initialInventory:o}=e,[y,p]=(0,l.useState)(o||A),[f,S]=(0,l.useState)({name:"",description:"",price:0,unit:"piece",category:A.categories[0]}),[w,D]=(0,l.useState)("");(0,l.useEffect)(()=>{t&&o&&p(o)},[t,o]);let z=()=>{if(f.name&&f.description&&void 0!==f.price){let e={...f,id:Date.now().toString(),sku:"SKU-".concat(Date.now().toString().slice(-6))};p({...y,items:[...y.items,e]}),S({name:"",description:"",price:0,unit:"piece",category:y.categories[0]})}},E=e=>{p({...y,items:y.items.filter(t=>t.id!==e)})},T=()=>{w&&!y.categories.includes(w)&&(p({...y,categories:[...y.categories,w]}),D(""))},I=e=>{p({...y,categories:y.categories.filter(t=>t!==e)})},Y=()=>{try{localStorage.setItem("quickinvoice_inventory",JSON.stringify(y)),i(y),a()}catch(e){console.error("Error saving inventory:",e)}},P=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return(0,s.jsx)(j.Y,{size:"4xl",isOpen:t,onClose:a,scrollBehavior:"inside",children:(0,s.jsx)(b.g,{children:e=>{var t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.c,{children:"Inventory Management"}),(0,s.jsx)(N.h,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Categories"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:y.categories.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-gray-100 px-3 py-1 rounded",children:[(0,s.jsx)("span",{children:e}),"Other"!==e&&(0,s.jsx)("button",{onClick:()=>I(e),className:"text-red-500 hover:text-red-700",children:"\xd7"})]},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.r,{placeholder:"New Category",value:w,onChange:e=>D(e.target.value)}),(0,s.jsx)(c.T,{color:"primary",onPress:T,children:"Add Category"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Items"}),(0,s.jsxs)(u.j,{"aria-label":"Inventory items",children:[(0,s.jsxs)(m.X,{children:[(0,s.jsx)(x.e,{children:"Name"}),(0,s.jsx)(x.e,{children:"Description"}),(0,s.jsx)(x.e,{children:"Category"}),(0,s.jsx)(x.e,{children:"Price"}),(0,s.jsx)(x.e,{children:"Unit"}),(0,s.jsx)(x.e,{children:"SKU"}),(0,s.jsx)(x.e,{children:"Actions"})]}),(0,s.jsx)(h.E,{children:y.items.map(e=>(0,s.jsxs)(g.s,{children:[(0,s.jsx)(v.w,{children:e.name}),(0,s.jsx)(v.w,{children:e.description}),(0,s.jsx)(v.w,{children:e.category}),(0,s.jsx)(v.w,{children:P(e.price)}),(0,s.jsx)(v.w,{children:e.unit}),(0,s.jsx)(v.w,{children:e.sku}),(0,s.jsx)(v.w,{children:(0,s.jsx)(c.T,{color:"danger",size:"sm",onPress:()=>E(e.id),children:"Remove"})})]},e.id))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 mt-4",children:[(0,s.jsx)(d.r,{label:"Name",value:f.name,onChange:e=>S({...f,name:e.target.value})}),(0,s.jsx)(d.r,{label:"Description",value:f.description,onChange:e=>S({...f,description:e.target.value})}),(0,s.jsx)(r.d,{label:"Category",selectedKeys:[f.category||""],onChange:e=>S({...f,category:e.target.value}),children:y.categories.map(e=>(0,s.jsx)(n.y,{value:e,children:e},e))}),(0,s.jsx)(d.r,{type:"number",label:"Price",value:null===(t=f.price)||void 0===t?void 0:t.toString(),onChange:e=>S({...f,price:Number(e.target.value)})}),(0,s.jsx)(d.r,{label:"Unit",value:f.unit,onChange:e=>S({...f,unit:e.target.value})}),(0,s.jsx)(c.T,{color:"primary",onPress:z,className:"mt-6",children:"Add Item"})]})]})]})}),(0,s.jsxs)(F.q,{children:[(0,s.jsx)(c.T,{color:"danger",variant:"light",onPress:e,children:"Cancel"}),(0,s.jsx)(c.T,{color:"primary",onPress:Y,children:"Save Inventory"})]})]})}})})}function R(e){let{isOpen:t,onClose:a,onDownload:r,pdfDataUrl:n}=e,i=(0,l.useRef)(null);return(0,l.useEffect)(()=>{t&&i.current&&(i.current.src=n)},[t,n]),(0,s.jsx)(j.Y,{size:"5xl",isOpen:t,onClose:a,scrollBehavior:"inside",children:(0,s.jsx)(b.g,{children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.c,{children:"Preview Invoice"}),(0,s.jsx)(N.h,{children:(0,s.jsx)("div",{className:"w-full h-[600px] bg-gray-100 rounded-lg overflow-hidden",children:(0,s.jsx)("iframe",{ref:i,className:"w-full h-full",title:"PDF Preview"})})}),(0,s.jsxs)(F.q,{children:[(0,s.jsx)(c.T,{color:"danger",variant:"light",onPress:e,children:"Cancel"}),(0,s.jsx)(c.T,{color:"primary",onPress:r,children:"Download PDF"})]})]})})})}var B=a(70719),k=a.n(B),M=a(17146),U=a(27058),q=a(44595);async function O(e){try{let t=(0,U.H9)(q.db,"settings",e),a=await (0,U.x7)(t);return a.exists()?a.data():null}catch(e){return console.error("Error getting user settings:",e),null}}async function H(e,t){try{let a=(0,U.H9)(q.db,"settings",e);await (0,U.BN)(a,t,{merge:!0})}catch(e){throw console.error("Error saving user settings:",e),e}}async function K(e,t){try{let a=(0,U.H9)((0,U.rJ)(q.db,"invoices"));await (0,U.BN)(a,{...t,userId:e,createdAt:new Date().toISOString()})}catch(e){throw console.error("Error saving invoice:",e),e}}function _(){var e;let{user:t}=(0,M.A)(),[a,j]=(0,l.useState)(p.a),[b,C]=(0,l.useState)(!1),[N,S]=(0,l.useState)(null),[w,D]=(0,l.useState)(1),[F,z]=(0,l.useState)(A),[E,T]=(0,l.useState)(!1),[I,B]=(0,l.useState)(!1),[U,q]=(0,l.useState)(""),_=(0,l.useCallback)(e=>{let{invoicePrefix:t,nextInvoiceNumber:a}=e,s=a.toString().padStart(4,"0");return"".concat(t,"-").concat(s)},[]),[V,L]=(0,l.useState)(()=>{var e;return{invoiceNumber:_(p.a.template),date:new Date().toISOString().split("T")[0],dueDate:new Date(Date.now()+864e5*p.a.defaultDueDays).toISOString().split("T")[0],clientName:"",clientEmail:"",clientAddress:"",yourName:p.a.defaultBusinessName,yourEmail:p.a.defaultBusinessEmail,yourAddress:p.a.defaultBusinessAddress,items:[],taxRate:(null===(e=p.a.taxRates.find(e=>e.isDefault))||void 0===e?void 0:e.rate)||p.a.defaultTaxRate,notes:p.a.defaultNotes}}),J=(0,l.useMemo)(()=>V.items.reduce((e,t)=>e+t.quantity*t.price,0),[V.items]),G=(0,l.useMemo)(()=>J*V.taxRate,[J,V.taxRate]),Z=(0,l.useMemo)(()=>J+G,[J,G]);(0,l.useCallback)(k()(e=>{L(t=>({...t,...e}))},300),[]);let Q=(0,l.useCallback)(e=>t=>{L(a=>({...a,[e]:t.target.value}))},[]),W=(0,l.useCallback)(async(e,s)=>{console.log("Saving to Firestore:",{name:e,value:s});try{if(!t){console.error("No user found when trying to save data");return}let l={...V,[e]:s};L(l),await H(t.uid,{...a,defaultBusinessName:l.yourName,defaultBusinessEmail:l.yourEmail,defaultBusinessAddress:l.yourAddress}),console.log("Successfully saved to Firestore")}catch(e){console.error("Error saving to Firestore:",e)}},[V,t]),$=(0,l.useCallback)(e=>{L(t=>({...t,items:t.items.filter(t=>t.id!==e)}))},[]),X=(0,l.useCallback)(()=>{if(N){let e={id:Date.now().toString(),description:"".concat(N.name," - ").concat(N.description),quantity:w,price:N.price};L(t=>({...t,items:[...t.items,e]})),S(null),D(1)}},[N,w]),ee=(0,l.useCallback)(e=>{let t=a.availableCurrencies.find(e=>e.code===a.defaultCurrency);return new Intl.NumberFormat("en-US",{style:"currency",currency:a.defaultCurrency,currencyDisplay:"symbol"}).format(e).replace((null==t?void 0:t.code)||a.defaultCurrency,(null==t?void 0:t.symbol)||"$")},[a.availableCurrencies,a.defaultCurrency]),et=(0,l.useCallback)(e=>{let t=new Date(e),s=a.template.dateFormat,l=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0"),n=t.getFullYear();switch(s){case"MM/DD/YYYY":return"".concat(l,"/").concat(r,"/").concat(n);case"DD/MM/YYYY":return"".concat(r,"/").concat(l,"/").concat(n);case"YYYY-MM-DD":return"".concat(n,"-").concat(l,"-").concat(r);default:return e}},[a.template.dateFormat]);(0,l.useEffect)(()=>{(async()=>{try{if(!t){console.log("No user found when trying to load settings");return}let a=await O(t.uid);if(a){var e;let t={...p.a,...a,template:{...p.a.template,...a.template,fontSize:{...p.a.template.fontSize,...(null===(e=a.template)||void 0===e?void 0:e.fontSize)||{}}}};j(t),L(e=>({...e,yourName:t.defaultBusinessName||"",yourEmail:t.defaultBusinessEmail||"",yourAddress:t.defaultBusinessAddress||"",taxRate:t.defaultTaxRate,notes:t.defaultNotes}))}}catch(e){console.error("Error loading settings from Firestore:",e)}})()},[t]);let ea=async e=>{try{var a;if(!t){console.error("No user found when trying to save settings");return}let s={...e,template:{...p.a.template,...e.template,fontSize:{...p.a.template.fontSize,...(null===(a=e.template)||void 0===a?void 0:a.fontSize)||{}}}};await H(t.uid,s),j(s),L(e=>({...e,yourName:s.defaultBusinessName,yourEmail:s.defaultBusinessEmail,yourAddress:s.defaultBusinessAddress,taxRate:s.defaultTaxRate,notes:s.defaultNotes}))}catch(e){console.error("Error saving settings to Firestore:",e)}},es=(0,l.useCallback)(async()=>{try{if(!t){console.error("No user found when trying to generate PDF");return}await K(t.uid,{...V,subtotal:ex(V.items),tax:eh(V.items,V.taxRate),total:eg(V.items,V.taxRate)}),console.log("Successfully saved invoice to Firestore");let e=er().output("dataurlstring");q(e),B(!0)}catch(e){console.error("Error generating PDF and saving to Firestore:",e)}},[V,t]),el=async()=>{try{if(!t){console.error("No user found when trying to save invoice");return}er().save("invoice.pdf");let e={...a,template:{...a.template,nextInvoiceNumber:a.template.nextInvoiceNumber+1}};await H(t.uid,e),j(e),B(!1)}catch(e){console.error("Error saving settings after download:",e)}},er=()=>{let e=new f.uE,{template:t}=a;e.setFont(t.fontFamily);let s=0;if(a.logoEnabled)try{let a=localStorage.getItem("quickinvoice_logo");a&&("modern"===t.layout&&t.showHeader&&(e.setFillColor(t.primaryColor),e.rect(0,0,e.internal.pageSize.width,50,"F")),e.setFillColor(255,255,255),e.rect(15,15,50,50,"F"),e.addImage(a,"JPEG",20,20,40,40),s=30,t.showHeader&&(e.setFontSize(t.fontSize.header),e.setTextColor("modern"===t.layout?"#FFFFFF":t.primaryColor),e.text("INVOICE",105,40,{align:"center"})))}catch(e){console.error("Error adding logo:",e),s=0}else t.showHeader&&("modern"===t.layout?(e.setFillColor(t.primaryColor),e.rect(0,0,e.internal.pageSize.width,30,"F"),e.setTextColor("#FFFFFF")):e.setTextColor(t.primaryColor),e.setFontSize(t.fontSize.header),e.text("INVOICE",105,20,{align:"center"}));e.setFontSize(t.fontSize.body),e.setTextColor(t.secondaryColor),e.text("Invoice #: ".concat(V.invoiceNumber),20,40+s),e.text("Date: ".concat(et(V.date)),20,45+s),e.text("Due Date: ".concat(et(V.dueDate)),20,50+s),e.setFontSize(t.fontSize.subheader),e.setTextColor(t.primaryColor),e.text("From:",20,65+s),e.setFontSize(t.fontSize.body),e.setTextColor(t.secondaryColor),e.text(V.yourName,20,70+s),e.text(V.yourEmail,20,75+s),e.text(V.yourAddress,20,80+s),e.setFontSize(t.fontSize.subheader),e.setTextColor(t.primaryColor),e.text("Bill To:",20,95+s),e.setFontSize(t.fontSize.body),e.setTextColor(t.secondaryColor),e.text(V.clientName,20,100+s),e.text(V.clientEmail,20,105+s),e.text(V.clientAddress,20,110+s),e.setFontSize(t.fontSize.subheader),e.setTextColor(t.primaryColor),e.text("Description",20,130+s),e.text("Qty",100,130+s),e.text("Price",130,130+s),e.text("Amount",160,130+s),e.setFontSize(t.fontSize.body),e.setTextColor(t.secondaryColor);let l=140+s;if(V.items.forEach(t=>{e.text(t.description,20,l),e.text(t.quantity.toString(),100,l),e.text(ee(t.price),130,l),e.text(ee(t.quantity*t.price),160,l),l+=10}),l+=10,e.text("Subtotal: ".concat(ee(J)),130,l),l+=10,e.text("Tax (".concat((100*V.taxRate).toFixed(0),"%): ").concat(ee(G)),130,l),l+=10,e.setFontSize(t.fontSize.subheader),e.setTextColor(t.primaryColor),e.text("Total: ".concat(ee(Z)),130,l),V.notes&&(l+=20,e.setFontSize(t.fontSize.subheader),e.text("Notes:",20,l),e.setFontSize(t.fontSize.body),e.setTextColor(t.secondaryColor),e.text(V.notes,20,l+10)),t.showFooter){e.setFontSize(t.fontSize.body),e.setTextColor(t.secondaryColor);let a=e.internal.pageSize.height-20;e.text("Thank you for your business!",105,a,{align:"center"})}return"minimal"===t.layout&&(e.setDrawColor(t.secondaryColor),e.setLineWidth(.1),e.line(20,85+s,190,85+s),e.line(20,115+s,190,115+s)),e},en=(0,l.useCallback)(()=>(0,s.jsx)(r.d,{label:"Tax Rate",selectedKeys:[V.taxRate.toString()],onChange:e=>L(t=>({...t,taxRate:Number(e.target.value)})),children:a.taxRates.map(e=>(0,s.jsxs)(n.y,{value:e.rate.toString(),textValue:"".concat(e.name," ").concat((100*e.rate).toFixed(0),"%"),children:[e.name," (",(100*e.rate).toFixed(0),"%)"]},e.rate.toString()))}),[V.taxRate,a.taxRates,L]),ei=async()=>{try{if(!t){console.error("No user found when trying to save client");return}if(V.clientName&&V.clientEmail){let e={id:Date.now().toString(),name:V.clientName,email:V.clientEmail,address:V.clientAddress},s={...a,savedClients:[...a.savedClients,e]};await H(t.uid,s),j(s)}}catch(e){console.error("Error saving client to Firestore:",e)}},eo=async()=>{try{if(!t){console.error("No user found when trying to save template");return}let e={id:Date.now().toString(),date:V.date,invoiceNumber:V.invoiceNumber,client:{id:Date.now().toString(),name:V.clientName,email:V.clientEmail,address:V.clientAddress},items:V.items.map(e=>{let{description:t,quantity:a,price:s}=e;return{description:t,quantity:a,price:s}})},s={...a,recentInvoices:[e,...a.recentInvoices.slice(0,9)]};await H(t.uid,s),j(s)}catch(e){console.error("Error saving template to Firestore:",e)}},ec=e=>{L(t=>({...t,clientName:e.name,clientEmail:e.email,clientAddress:e.address}))},ed=e=>{L(t=>({...t,clientName:e.client.name,clientEmail:e.client.email,clientAddress:e.client.address,items:e.items.map(e=>({id:Date.now().toString(),description:e.description,quantity:e.quantity,price:e.price}))}))},eu=(0,l.useCallback)(()=>(0,s.jsx)(r.d,{label:"Select Client",onChange:e=>{let t=a.savedClients.find(t=>t.id===e.target.value);t&&ec(t)},children:a.savedClients.map(e=>(0,s.jsx)(n.y,{value:e.id,textValue:e.name,children:e.name},e.id))}),[a.savedClients,ec]),em=(0,l.useCallback)(()=>(0,s.jsx)(r.d,{label:"Currency",selectedKeys:[a.defaultCurrency],onChange:e=>{let t={...a,defaultCurrency:e.target.value};localStorage.setItem("quickinvoice_settings",JSON.stringify(t)),j(t)},children:a.availableCurrencies.map(e=>(0,s.jsxs)(n.y,{value:e.code,textValue:"".concat(e.symbol," ").concat(e.name),children:[e.symbol," - ",e.name]},e.code))}),[a,j]),ex=e=>e.reduce((e,t)=>e+t.price*t.quantity,0),eh=(e,t)=>ex(e)*(t/100),eg=(e,t)=>ex(e)+eh(e,t),ev=(0,l.useCallback)((e,t)=>{L(a=>({...a,[e]:t})),W(e,t)},[W]);return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)(i.Z,{className:"mb-8",children:(0,s.jsxs)(o.U,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"QuickInvoice Generator"}),(0,s.jsx)(c.T,{color:"secondary",onPress:()=>C(!0),children:"Settings"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[(0,s.jsx)(d.r,{label:"Invoice Number",value:V.invoiceNumber,readOnly:!0}),(0,s.jsx)(d.r,{type:"date",label:"Date",value:V.date,onChange:Q("date")}),(0,s.jsx)(d.r,{type:"date",label:"Due Date",value:V.dueDate,onChange:Q("dueDate")}),(0,s.jsx)(en,{}),(0,s.jsx)(em,{})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)(d.r,{label:"Your Name",value:V.yourName,onChange:e=>ev("yourName",e.target.value)}),(0,s.jsx)(d.r,{label:"Your Email",value:V.yourEmail,onChange:Q("yourEmail")}),(0,s.jsx)(d.r,{label:"Your Address",value:V.yourAddress,onChange:Q("yourAddress")})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Client Details"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(c.T,{color:"primary",variant:"flat",onPress:ei,isDisabled:!V.clientName||!V.clientEmail,children:"Save Client"}),(0,s.jsx)(c.T,{color:"secondary",variant:"flat",onPress:eo,isDisabled:0===V.items.length,children:"Save as Template"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,s.jsx)(eu,{}),(0,s.jsx)(d.r,{label:"Client Name",value:V.clientName,onChange:Q("clientName")}),(0,s.jsx)(d.r,{label:"Client Email",value:V.clientEmail,onChange:Q("clientEmail")}),(0,s.jsx)(d.r,{label:"Client Address",value:V.clientAddress,onChange:Q("clientAddress")})]})]}),a.recentInvoices.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Recent Templates"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.recentInvoices.map(e=>(0,s.jsx)(i.Z,{className:"p-4",children:(0,s.jsxs)(o.U,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.client.name}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.invoiceNumber})]}),(0,s.jsx)(c.T,{size:"sm",color:"primary",onPress:()=>ed(e),children:"Use Template"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.items.length," items - Total: ",ee(e.items.reduce((e,t)=>e+t.quantity*t.price,0))]})]})},e.id))})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Items"}),(0,s.jsx)(c.T,{color:"primary",variant:"flat",onPress:()=>T(!0),children:"Manage Inventory"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,s.jsx)(r.d,{label:"Select Item",selectedKeys:N?[N.id]:[],onChange:e=>{S(F.items.find(t=>t.id===e.target.value)||null)},children:F.items.map(e=>(0,s.jsxs)(n.y,{value:e.id,textValue:"".concat(e.name," ").concat(ee(e.price)),children:[e.name," (",ee(e.price),")"]},e.id))}),(0,s.jsx)(d.r,{type:"number",label:"Quantity",value:w.toString(),onChange:e=>D(Number(e.target.value)),min:1}),(0,s.jsx)(c.T,{color:"primary",onPress:X,isDisabled:!N,className:"mt-6",children:"Add Item"})]}),(0,s.jsxs)(u.j,{"aria-label":"Invoice items",children:[(0,s.jsxs)(m.X,{children:[(0,s.jsx)(x.e,{children:"Description"}),(0,s.jsx)(x.e,{children:"Quantity"}),(0,s.jsx)(x.e,{children:"Price"}),(0,s.jsx)(x.e,{children:"Total"}),(0,s.jsx)(x.e,{children:"Actions"})]}),(0,s.jsx)(h.E,{children:V.items.map(e=>(0,s.jsxs)(g.s,{children:[(0,s.jsx)(v.w,{children:e.description}),(0,s.jsx)(v.w,{children:e.quantity}),(0,s.jsx)(v.w,{children:ee(e.price)}),(0,s.jsx)(v.w,{children:ee(e.quantity*e.price)}),(0,s.jsx)(v.w,{children:(0,s.jsx)(c.T,{color:"danger",size:"sm",onClick:()=>$(e.id),children:"Remove"})})]},e.id))})]})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex flex-col items-end",children:[(0,s.jsxs)("p",{className:"text-lg",children:["Subtotal: ",ee(J)]}),(0,s.jsxs)("p",{className:"text-lg",children:["Tax (",(null===(e=a.taxRates.find(e=>e.rate===V.taxRate))||void 0===e?void 0:e.name)||"Custom"," -",(100*V.taxRate).toFixed(0),"%): ",ee(G)]}),(0,s.jsxs)("p",{className:"text-xl font-bold",children:["Total: ",ee(Z)]})]})}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(y.P,{label:"Notes",value:V.notes,onChange:Q("notes")})}),(0,s.jsx)(c.T,{color:"primary",size:"lg",onClick:es,className:"w-full",children:"Preview Invoice"})]})}),(0,s.jsx)(Y,{isOpen:b,onClose:()=>C(!1),onSave:ea,initialSettings:a}),(0,s.jsx)(P,{isOpen:E,onClose:()=>T(!1),onSave:e=>{z(e)},initialInventory:F}),(0,s.jsx)(R,{isOpen:I,onClose:()=>B(!1),onDownload:el,pdfDataUrl:U})]})}},17146:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,O:()=>o});var s=a(95155),l=a(12115),r=a(14565),n=a(44595);let i=(0,l.createContext)({user:null,loading:!0,signInWithGoogle:async()=>{},logout:async()=>{}});function o(e){let{children:t}=e,[a,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(!0);(0,l.useEffect)(()=>n.j2.onAuthStateChanged(e=>{o(e),d(!1)}),[]);let u=async()=>{try{await (0,r.df)(n.j2,n.hJ)}catch(e){console.error("Error signing in with Google:",e)}},m=async()=>{try{await (0,r.CI)(n.j2)}catch(e){console.error("Error signing out:",e)}};return(0,s.jsx)(i.Provider,{value:{user:a,loading:c,signInWithGoogle:u,logout:m},children:!c&&t})}let c=()=>(0,l.useContext)(i)},44595:(e,t,a)=>{"use strict";a.d(t,{db:()=>c,hJ:()=>d,j2:()=>o});var s=a(49904),l=a(14565),r=a(27058);let n={apiKey:"AIzaSyDUVTA4ru-i5IW3iCVFUIn2i8dTB2Nbfno",authDomain:"testimonials-ea2a5.firebaseapp.com",projectId:"testimonials-ea2a5",storageBucket:"testimonials-ea2a5.firebasestorage.app",messagingSenderId:"776348387738",appId:"1:776348387738:web:3ae288121c71c7f7ae9223"};console.log("Initializing Firebase with config:",{projectId:n.projectId,authDomain:n.authDomain});let i=(0,s.Wp)(n),o=(0,l.xI)(i),c=(0,r.aU)(i),d=new l.HF;(0,r.ol)(c).catch(e=>{"failed-precondition"===e.code?console.error("Multiple tabs open, persistence can only be enabled in one tab at a time."):"unimplemented"===e.code&&console.error("The current browser doesn't support persistence.")})},16321:(e,t,a)=>{"use strict";a.d(t,{a:()=>s});let s={defaultBusinessName:"",defaultBusinessEmail:"",defaultBusinessAddress:"",defaultTaxRate:.1,defaultDueDays:30,defaultNotes:"Thank you for your business!",defaultCurrency:"USD",availableCurrencies:[{code:"USD",symbol:"$",name:"US Dollar"},{code:"EUR",symbol:"€",name:"Euro"},{code:"GBP",symbol:"\xa3",name:"British Pound"},{code:"JPY",symbol:"\xa5",name:"Japanese Yen"},{code:"CAD",symbol:"C$",name:"Canadian Dollar"},{code:"AUD",symbol:"A$",name:"Australian Dollar"}],logoEnabled:!1,taxRates:[{name:"Standard Rate",rate:.2,isDefault:!0},{name:"Reduced Rate",rate:.05},{name:"Zero Rate",rate:0}],template:{primaryColor:"#1a1a1a",secondaryColor:"#4f46e5",fontFamily:"helvetica",fontSize:{header:20,subheader:14,body:10},layout:"professional",showHeader:!0,showFooter:!0,dateFormat:"MM/DD/YYYY",invoicePrefix:"INV",nextInvoiceNumber:1001},branding:{primaryColor:"#1a1a1a",secondaryColor:"#4f46e5",fontFamily:"helvetica",fontSize:{header:20,subheader:14,body:10}},savedClients:[],recentInvoices:[]}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,895,930,13,936,861,288,757,565,293,441,517,358],()=>t(82173)),_N_E=e.O()}]);